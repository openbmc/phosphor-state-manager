{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b73105c5_3e264ab7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000008
      },
      "writtenOn": "2022-07-06T19:48:08Z",
      "side": 1,
      "message": "lgtm, though I don\u0027t consider myself a bash expert",
      "revId": "2899467312b06064ee000e7ac444051e90124596",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "656efbcf_59c31026",
        "filename": "scripts/host-reboot",
        "patchSetId": 3
      },
      "lineNbr": 1,
      "author": {
        "id": 1001428
      },
      "writtenOn": "2022-07-06T21:49:59Z",
      "side": 1,
      "message": "Just so I know that I\u0027m interpreting all of this correctly. The host shutdown target was not running since the host_crash target was hit first, and therefore was not not allowed to properly shutdown the host. You added a conflict with the host-stop target so that the crash target was not hit before the host-stop target. The script you added is then called during a phosphor-reboot service to apply the proper target to systemd.",
      "revId": "2899467312b06064ee000e7ac444051e90124596",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "97e2c7ad_9a3981d1",
        "filename": "scripts/host-reboot",
        "patchSetId": 3
      },
      "lineNbr": 1,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2022-07-07T18:47:04Z",
      "side": 1,
      "message": "So the old implementation before this commit, was to always run this in the reboot service:\n\nExecStart\u003d/bin/sh -c \"sleep 5 \u0026\u0026 systemctl start obmc-host-startmin@%i.target\"\n\nThat meant no matter what, we always rebooted the host, even if the host had used all if it\u0027s reboot attempts. This new bash script was added to ensure we don\u0027t reboot the host if it has used all of it\u0027s reboot attempts. So instead of blindly starting the target that boots the host, we check the reboot count now. If the host is out of reboots, we go to host-quiesce.",
      "parentUuid": "656efbcf_59c31026",
      "revId": "2899467312b06064ee000e7ac444051e90124596",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}