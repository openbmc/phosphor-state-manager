{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "122db244_36696f0e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001198
      },
      "writtenOn": "2024-10-11T14:38:06Z",
      "side": 1,
      "message": "Hi @Andrew and @Tim, I add this commit fix the issue we discussed before https://gerrit.openbmc.org/c/openbmc/phosphor-state-manager/+/74319/comments/39da96e1_0359d8a7",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a0bcfd35_24537304",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000294
      },
      "writtenOn": "2024-10-14T06:27:03Z",
      "side": 1,
      "message": "Hi @Thang,\nFrom the IPMI Specification v2.0 revision 1.1. \"The power restore policy determines how the system or chassis behaves when AC power returns after an AC power loss.\"\n\nIt seems both `Watchdog` and `Software` are not caused by AC power loss like `PinholeReset`.\nTherefore, checking the `PinholeReset` reason and not running power restore policy seems reasonable.\n\nSince it is a manual mechanism for the user to force a hard reset to the BMC in situations where it is hung or not responding, should we keep the hard reset `PinholeReset` and remove the software reset regardless of whether it is Watchdog or Software?\n\nHi @Andrew,\nIf I am wrong, please correct me. Thanks.",
      "parentUuid": "122db244_36696f0e",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6d25b3c6_c380df70",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000940
      },
      "writtenOn": "2024-10-15T02:31:00Z",
      "side": 1,
      "message": "I think Thang Tran is wrong on the commit title and message. The change he made is for BMC reboot cause but the title and message say about Power Restore Policy. They are different features.",
      "parentUuid": "a0bcfd35_24537304",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "03ad382e_fdde3224",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000294
      },
      "writtenOn": "2024-10-15T02:38:38Z",
      "side": 1,
      "message": "According to Thang\u0027s change, it seems that when RebootCause is Software or Watchdog then return 0 and does not apply any power restore policy. So, I think he wants to connect with them.",
      "parentUuid": "6d25b3c6_c380df70",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b73ce5d7_4ae24c93",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001198
      },
      "writtenOn": "2024-10-15T04:28:33Z",
      "side": 1,
      "message": "\u003e Since it is a manual mechanism for the user to force a hard reset to the BMC in situations where it is hung or not responding, should we keep the hard reset PinholeReset and remove the software reset regardless of whether it is Watchdog or Software?\n\n@Tim, I think the APR only should be run when AC loss, other case like PinholeReset/Software/Watchdog, BMC does nothing.\n\na @Thang, I will update the commit message",
      "parentUuid": "03ad382e_fdde3224",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "442cf76d_7cbac28b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000294
      },
      "writtenOn": "2024-10-15T06:21:12Z",
      "side": 1,
      "message": "Due to I read the power-recovery.md about blackout, so I think that PinholeReset simulate AC loss.\n\n\"A blackout occurs when AC power is cut from the system, resulting in a total loss of power if there is no UPS installed to keep the system on. To identify this scenario after a BMC reboot, chassis-state-manager will check to see what the last power state was before the loss of power and compares it against the pgood pin. Blackouts can be intentionally triggered by a user (i.e a pinhole reset)\n\"\n\nShould add the other resets description in this remark?\nhttps://github.com/openbmc/phosphor-state-manager/blob/master/discover_system_state.cpp#L82",
      "parentUuid": "b73ce5d7_4ae24c93",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b854d0d3_1185389a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001198
      },
      "writtenOn": "2024-10-15T06:35:52Z",
      "side": 1,
      "message": "In the https://github.com/openbmc/docs/blob/master/designs/power-recovery.md#bmc-and-system-recovery-paths-1, it mentions that `If the power recovery software sees the PinholeReset reason within the RebootCause then it will not implement any of its policy`. Therefore, if the RebootCause is `PinholeReset`, the BMC should do nothing.",
      "parentUuid": "442cf76d_7cbac28b",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f120e91e_fb822468",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000294
      },
      "writtenOn": "2024-10-15T06:51:30Z",
      "side": 1,
      "message": "So this description need to change also, right?\n```If the power recovery software sees the PinholeReset, Software or Watchdog...\nTherefore, if the RebootCause is PinholeReset, Software or Watchdog, the BMC should do nothing.```",
      "parentUuid": "b854d0d3_1185389a",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "87d38496_c2356815",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001198
      },
      "writtenOn": "2024-10-15T07:00:23Z",
      "side": 1,
      "message": "I agree with you @Tim.\n@Andrew, what do you think with the @Tim\u0027s suggestion.",
      "parentUuid": "f120e91e_fb822468",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2be0d959_8a7050ed",
        "filename": "discover_system_state.cpp",
        "patchSetId": 1
      },
      "lineNbr": 99,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2024-10-13T16:15:08Z",
      "side": 1,
      "message": "I think it\u0027s time to update https://github.com/openbmc/docs/blob/master/designs/power-recovery.md for both of these (similar to what was done for PinholeReset) because I\u0027m not sure we want these. The argument seems to be to only run APR when something unexpected happens (like an AC loss) but I think some want the Always Power On option to be always run after a BMC reset.",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0a8370a_540556d0",
        "filename": "discover_system_state.cpp",
        "patchSetId": 1
      },
      "lineNbr": 99,
      "author": {
        "id": 1001198
      },
      "writtenOn": "2024-10-15T04:28:33Z",
      "side": 1,
      "message": "\u003e The argument seems to be to only run APR when something unexpected happens (like an AC loss) but I think some want the Always Power On option to be always run after a BMC reset.\n\n@Andrew, For the old implementation, I don\u0027t see any change the APR can be run after BMC cold reset. Do you know any platform want to run APR after BMC cold reset?",
      "parentUuid": "2be0d959_8a7050ed",
      "revId": "d970aea1450185474219219394166f744fe8de4f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}